---
layout: default
---

<style>
  h3 {
    display:none;
  }
  
  #bar {
    background-color: #f5f5f5;
    width: 100%;
    clear: both;
    height: 1.5em;
    overflow: visible;
  }
  #progress {
    font-size: 16px;
    height: 1.5em;
    width: 0;
    overflow: visible;
    background-color: #d0d0d0;
  }
  #progress a {
    color: #000000;
    margin-left: 48px;
  }
  #t, #pl {
    height: 1.5em;
    margin-bottom: -1.5em;
  }
  #t {
    float: right;
    margin-right: 12px;
  }
  #pl {
    float: left;
    margin-left: 12px;
  }
  #playlist {
    width: 100%;
    clear: both;
    position: absolute;
    visibility: hidden;
    z-index: 10;
  }
  
  #mapdiv {
    float:none;
    width: 100%;
    height: 480px;
  }
</style>

<h3>Contest</h3>

<audio id="audio" onended="stopPlayback();">
  <source src="/assets/mp3/nightingale_bird.mp3" type="audio/mpeg">
  <embed src="https://freealise.com/assets/mp3/album.mp3" type="audio/mpeg" height="32" width="256"></embed>
</audio>

    <a id="pl" href="javascript:showPlaylist();" title="Playlist"><i class="material-icons notranslate">queue_music</i></a>
    <div id="bar">
      <div id="progress">
        <a href="javascript:if(pb.innerText!='pause'){startPlayback();}else{stopPlayback();}" title="Play | Pause">
          <i id="pb" class="material-icons notranslate">play_arrow</i>
        </a>
      </div>
      <div id="playlist"></div>
      <script src='https://www.gstatic.com/charts/loader.js' type='text/javascript'></script>
      <script type="text/javascript">
        var pb = document.getElementById('pb');
        var _t;
        function startPlayback() {
          audio.play();
          pb.innerText = 'pause';
          _t = setInterval(function(){
            var c = parseInt(document.getElementById('audio').currentTime);
            var d = parseInt(document.getElementById('audio').duration);
            document.getElementById('progress').style.width = 100 * c / d + "%"; 
          }, 1000);
        }
        function stopPlayback() {
          audio.pause();
          pb.innerText = 'play_arrow';
          clearInterval(_t);
        }

        var playlist = document.getElementById('playlist');
        playlist.style.visibility = 'hidden';
        function showPlaylist() {
          if (playlist.style.visibility != 'hidden') {
            playlist.style.visibility = 'hidden';
          } else {
            playlist.style.visibility = 'visible';
          }
        }

        var audio = document.getElementById('audio');
        google.charts.load('current', {'packages':['timeline']});
        google.charts.setOnLoadCallback(drawChart);
        window.onresize = drawChart;
        function drawChart() {
          var chart = new google.visualization.Timeline(playlist);
          var dataTable = new google.visualization.DataTable();

          var chartwidth = document.getElementById('bar').clientWidth;
          var options = {
            width: chartwidth,
            chartArea: {
              width: chartwidth
            },
            timeline: { barLabelStyle: { fontName: 'Averia Serif Libre', fontSize: 12 }, showRowLabels: false, singleColor: '#cccccc' },
            hAxis: { format: ' ' }
          };
          var min = 60000;
          var sec = 1000;

          dataTable.addColumn({ type: 'string', id: 'Number' });
          dataTable.addColumn({ type: 'string', id: 'Song' });
          dataTable.addColumn({ type: 'datetime', id: 'Start' });
          dataTable.addColumn({ type: 'datetime', id: 'End' });
          dataTable.addRows([
            [ '1', 'Nightingale', new Date(0), new Date(1*min+39*sec) ],
            [ '2', 'Skylark', new Date(1*min+39*sec),  new Date(2*min+59*sec) ],
            [ '3', 'Parrot', new Date(2*min+59*sec),  new Date(3*min+59*sec) ]
          ]);

          function selectHandler() {
            var selectedItem = chart.getSelection()[0];
            if (selectedItem) {
              audio.currentTime = dataTable.getValue(selectedItem.row, 2).getTime() / 1000;
              startPlayback();
            }
          }

          google.visualization.events.addListener(chart, 'select', selectHandler); 
          chart.draw(dataTable, options);
        }
      </script>
    </div>


<!-- The StoryMap container can go anywhere on the page. Be sure to
    specify a width and height.  The width can be absolute (in pixels) or
    relative (in percentage), but the height must be an absolute value.
    Of course, you can specify width and height with CSS instead -->
<div id="mapdiv"></div>

<link rel="stylesheet" href="https://cdn.knightlab.com/libs/storymapjs/latest/css/storymap.css"/>
<script type="text/javascript" src="https://cdn.knightlab.com/libs/storymapjs/latest/js/storymap-min.js"></script>

<script>
// storymap_data can be an URL or a Javascript object
var storymap_data = '/assets/js/events.json';
var storymap_options = {
  "language": "en",
  "map_type": "osm:standard",
  "map_as_image": false,
  "call_to_action": false,
  "call_to_action_text": "",
};

var storymap = new KLStoryMap.StoryMap('mapdiv', storymap_data, storymap_options);
window.onresize = function(event) {
    storymap.updateDisplay(); // this isn't automatic
}
</script>
